<!DOCTYPE html>
<html>

	<head>
	
		<title> Trivia Game </title>

		<meta charset="UTF-8">
		<meta name="description" content="Trivia Game">
		<meta name="author" content="">
	
		<style>
			.startScreen{
				
				width:  70%;
				height: 70%;
				
				padding:10%;
				
			}
			
			.triviaScreen{
			
				display:grid;
				
				grid-template-columns: auto 80% auto;
				grid-template-rows: auto 10% 30% 30% 10% auto;
			
				//display:none;
				
				height:90%;
				width:90%;
				

				
				padding:5%;
			}
			
			.endScreen{
				
				width:100%;
				height:100%;
				
				
				padding:50px;
			}
			
			.trivalSelection{
			
				display:grid;
				
				grid-template-columns: auto 95% auto;
				grid-template-rows: auto 10% 75% 10% auto;
				justify-content: center;
				align-content: center;
			
				
				height:100%;
				width:100%;				
		
			}
			
			body{
			
				display:grid;
				grid-template-columns: auto 80% auto;
				grid-template-rows: auto 80% auto;
				justify-content: center;
				align-content: center;
				
				min-height: 100%;
				height: 100%;
				margin: 0px;
				
				font-size:24px;
				background-image: linear-gradient(#00081a, #002066);
				
			}
			
			html{
			
				min-height:100%;
				min-width:100%;
				height:100%;
				width:100%;
			
			}
			
			.main{
			
				grid-column: 2;
				grid-row: 2;
						
				border-style: solid;
				border: 2px solid black; 
				border-collapse: collapse;	

				//background-color:#177013;
				background-color:#FFFFFF;
			
			}
			
			table{
				width:100%;
				height:100%;
			}
			
			table, th, td, tr{
			
				border: 2px solid black; 
				border-collapse: collapse;
				text-align:center;
			
			}
			
			.correctButton{
			
				background-color green;
			
			}
			
			.wrongButton{
			
				background-color: red;
				
			}
			
			.unselectedButton{
			
				background-color:blue;
				color: orange;
			
			}
			
			
		
		</style>
	</head>
	
	<body>
	
		<div class="main" id="main">
			
		</div>
		
		<script>
		
			let activeGame = {}
			
			//Save data
			
			//localStorage.savedata = 
			
			
			setup();	
			//startGame();
			
			//Called when the page is first loaded
			function setup(){
				
				activeGame.name = ""
			
				if(typeof(window.localStorage) !== "undefined"){
				
					console.log("Storage Works");
					
					if(typeof(window.localStorage.getItem('scores')) == undefined){
						window.localStorage.setItem('scores',[
						{name:null,score:1},{name:null,score:2},{name:null,score:3},
						{name:null,score:4},{name:null,score:5},{name:null,score:6},
						{name:null,score:7},{name:null,score:8},{name:null,score:9},
						{name:null,score:10}]);
					}
					
					
					if(typeof(window.localStorage.getItem("name")) != null || typeof(window.localStorage.getItem("name")) != undefined){
						activeGame.name = window.localStorage.getItem('name');
					} else {
						window.localStorage.setItem('name', '')
					}
				
				} else {
				
					console.log("Storage Failed");
				
				}				
			
				displayStartScreen();
				
				document.getElementById('nameForm').value = activeGame.name;
				
			}
			
			//Function that is called when starting a game
			function startGame() {
			
				//Make the game object
				
				
				//Question 
				
				activeGame = {};

				activeGame.name = "";
				if(document.getElementById('nameForm').value !== undefined){
					activeGame.name = document.getElementById('nameForm').value;
				}
				
				activeGame.score = 0;
				activeGame.activeQuestion = 0;
				activeGame.title = "";
				activeGame.selectedQuestions = [0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0];
				activeGame.caterogies = ["A","B","C","D","E"];
				activeGame.questions = [
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //1
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //2
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //3
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //4
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //5
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //6
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //7
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //8
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //9
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //10
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //11
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //12
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //13
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //14
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //15
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //16
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //17
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //18
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}, //19
					{question:"What colour is the sky?", answer:1, res1:"Blue",res2:"Orange",res3:"Red",res4:"Green",exp:""}  //20
				];
				
				//Sample question object: {question:"", res1:"", res2:"", res3:"", res4:"", answer:0}
				
				displayTriviaSelection();
				
				//Move the question Selection viewview
				//document.getElementById("trivalSelection").style.
			}
		
		
			function selectQuestion(col, row){
			
				let index = (col*5) + row;
			
			
				if(index%2){
					activeGame.selectedQuestions[index] = 1;
				}else{
					activeGame.selectedQuestions[index] = -1;
				}
			
				activeGame.activeQuestion = index;
			
				displayTriviaQuestion();
			
				console.log(`q${index}`);
			
			}
			
			function selectAnswer(ans) {
			
				//They are correct
				if(activeGame.questions[activeGame.activeQuestion].answer == ans){
				
					activeGame.selectedQuestions[activeGame.activeQuestion] = 1;
					activeGame.score += ((activeGame.activeQuestion % 5)+1) * 200;

				//If they are wrong
				} else {
			
					activeGame.selectedQuestions[activeGame.activeQuestion] = -1;
					activeGame.score -= ((activeGame.activeQuestion % 5)+1) * 200;
			
				}
				
				displayTriviaQuestion();
				
				let x = 0;
				
				for(x=1; x<5; x++){
				
					document.getElementById(`opt${x}`).onclick = "";
				
					//The correct answer
					if(x == activeGame.questions[activeGame.activeQuestion].answer){
						document.getElementById(`opt${x}`).style = "background-color:green; color:purple;";
					
					//The wrong answeres
					}else{
						document.getElementById(`opt${x}`).style = "background-color:red; color:green;";
					}
					
				}
				
				//Add the explination and the next button
				let nextButton = "<div onclick='displayEndScreen()'> Finished </div>";
				
				for (x = 0; x < 25; x++){
				
					if(activeGame.selectedQuestions[x] == 0){
						nextButton = "<div onclick='displayTriviaSelection()'> Continue </div>";
						break;
					}
				
				}
				
				document.getElementById("AnswerSection").innerHTML = `<div> ${activeGame.questions[activeGame.activeQuestion].exp} </div> <br> ${nextButton}`
				activeGame.activeQuestion = -1;
				
			}
		
			
			function displayStartScreen(){
			
				document.getElementById("main").innerHTML = `<!-- Start Screen -->
				<div class="startScreen" id="startScreen">
				
					<div style="height:5%; text-align:center;"></div>
					
					<div style="height:20%; text-align:center; border-style: solid; border: 2px solid black; border-collapse: collapse;	"> 
						Game Title 
					</div>
					
					<div style="height:25%"></div>
					
					<div style="text-align:center; height:30%;" id="QuestionSelection">
					
						<div style="display:inline-block; padding: 5px; width:20%; height:20%; background-color:aqua;"  onclick='displayLeaderBoard()'> Scores </div>
						<div style="display:inline-block; padding: 5px; width:20%; height:20%; background-color:aqua;"> Sources </div>
						<div style="display:inline-block; padding: 5px; width:20%; height:20%; background-color:aqua;" onclick="startGame()"> Start </div>

					</div>
					
					<div style="height:5%;"> </div>
					
					<div style="text-align:left;">
						<input type="text" style="display:inline-block; width:100%; height:42px; font-size:24px;" id="nameForm" value='${activeGame.name}' maxlength="128">
					</div>
					
				</div>`
			
			}
			
			function displayTriviaSelection(){
			
				document.getElementById("main").innerHTML = `<!-- Main Area  -->
				<div class="trivalSelection" id="trivalSelection">
				
					<!-- -->
					<div style="grid-column: 2; grid-row: 2;"> 
					
						<div style="display:inline-block; text-align: center;"> ${activeGame.title} </div> 
					
					</div>
				
					<!-- -->
					<table style="grid-column: 2; grid-row: 3;">
						
						<!-- The Titles of the caterogies -->
						<tr>
							<th id="questionheader0"> ${activeGame.caterogies[0] || 'Category 1'} </th>
							<th id="questionheader1"> ${activeGame.caterogies[1] || 'Category 2'} </th>
							<th id="questionheader2"> ${activeGame.caterogies[2] ||'Category 3'} </th>
							<th id="questionheader3"> ${activeGame.caterogies[3] ||'Category 4'} </th>
							<!-- <th id="questionheader4"> ${activeGame.caterogies[4] ||'Category 5'} </th>  -->
						</tr>
						
						
						<!-- Easy Questions -->
						<tr>
							<td id="q0" class="unselectedButton" onclick="selectQuestion(0,0)"> &#36;200 </button> </td>
							<td id="q5" class="unselectedButton" onclick="selectQuestion(1,0)"> &#36;200 </button> </td>
							<td id="q10" class="unselectedButton" onclick="selectQuestion(2,0)"> &#36;200 </button> </td>
							<td id="q15" class="unselectedButton" onclick="selectQuestion(3,0)"> &#36;200 </button> </td>
							<!-- <td id="q20" class="unselectedButton" onclick="selectQuestion(4,0)"> &#36;200 </button> </td>  -->
						</tr>				
						

						<!-- -->
						<tr>
							<td id="q1" class="unselectedButton" onclick="selectQuestion(0,1)"> &#36;400 </td>
							<td id="q6" class="unselectedButton" onclick="selectQuestion(1,1)"> &#36;400 </button> </td>
							<td id="q11" class="unselectedButton" onclick="selectQuestion(2,1)"> &#36;400 </button> </td>
							<td id="q16" class="unselectedButton" onclick="selectQuestion(3,1)"> &#36;400 </button> </td>
							<!-- <td id="q21" class="unselectedButton" onclick="selectQuestion(4,1)"> &#36;400 </button> </td>  -->
						</tr>				
						
						
						<!-- -->
						<tr>
							<td id="q2" class="unselectedButton" onclick="selectQuestion(0,2)"> &#36;600 </button> </td>
							<td id="q7" class="unselectedButton" onclick="selectQuestion(1,2)"> &#36;600 </button> </td>
							<td id="q12" class="unselectedButton" onclick="selectQuestion(2,2)"> &#36;600 </button> </td>
							<td id="q17" class="unselectedButton" onclick="selectQuestion(3,2)"> &#36;600 </button> </td>
							<!-- <td id="q22" class="unselectedButton" onclick="selectQuestion(4,2)"> &#36;600 </button> </td>  -->
						</tr>				
						
						
						<!-- -->
						<tr>
							<td id="q3" class="unselectedButton" onclick="selectQuestion(0,3)"> &#36;800 </button> </td>
							<td id="q8" class="unselectedButton" onclick="selectQuestion(1,3)"> &#36;800 </button> </td>
							<td id="q13" class="unselectedButton" onclick="selectQuestion(2,3)"> &#36;800 </button> </td>
							<td id="q18" class="unselectedButton" onclick="selectQuestion(3,3)"> &#36;800 </button> </td>
							<!-- <td id="q23" class="unselectedButton" onclick="selectQuestion(4,3)"> &#36;800 </button> </td>  -->
						</tr>				
						
						
						<!-- Hardest Questions -->
						<tr>
							<td id="q4"   class="unselectedButton" onclick="selectQuestion(0,4)"> &#36;1000 </button> </td>
							<td id="q9"   class="unselectedButton" onclick="selectQuestion(1,4)"> &#36;1000 </button> </td>
							<td id="q14"  class="unselectedButton" onclick="selectQuestion(2,4)"> &#36;1000 </button> </td>
							<td id="q19"  class="unselectedButton" onclick="selectQuestion(3,4)"> &#36;1000 </button> </td>
							<!-- <td id="q24" class="unselectedButton" onclick="selectQuestion(4,4)"> &#36;1000 </button> </td>   -->
						</tr>
							
							
					</table>

					<!-- -->
					<div id="GameStatus" style="grid-column: 2; grid-row: 4; padding-top:20px; font-size:24px; width: 100%;">
							<div style="display:inline-block; text-align: left;"> Player: ${activeGame.name || 'You'} </div> 
							<div style="display:inline-block; text-align: right;" id="Score"> Score: &#36; ${activeGame.score}</div>
					</div>
						
				</div>`;
				
				let x = 0;
				for (x = 0; x<20; x++){
					
					//Not selected, can skip
					if(activeGame.selectedQuestions[x] == 0){
						continue;
					}
					
					//Was correctly selected
					if(activeGame.selectedQuestions[x] == 1){
						document.getElementById(`q${x}`).style = "background-color:green; color:purple;";
					}
					
					//Was incorrectly selected
					if(activeGame.selectedQuestions[x] == -1){
						document.getElementById(`q${x}`).style = "background-color:red; color:green;";
					}
					
					document.getElementById(`q${x}`).onclick = "";
				
				} 
			
			}
			
			function displayTriviaQuestion(){
			
			
				document.getElementById('main').innerHTML = `<!-- Triva Questions  -->
					<div class="triviaScreen" id="triviaScreen">
						<div id="gameQuestion" style="grid-row:2; grid-column:2;"> ${activeGame.questions[activeGame.activeQuestion].question} </div>
						<br>
						<table id="answerButtons" style="grid-row:3; grid-column:2;">
							
							<tr>
								<td onclick="selectAnswer(1)" id="opt1"> ${activeGame.questions[activeGame.activeQuestion].res1} </td>
								<td onclick="selectAnswer(2)" id="opt2"> ${activeGame.questions[activeGame.activeQuestion].res2} </td>
							</tr>
							
							<tr>
								<td onclick="selectAnswer(3)" id="opt3"> ${activeGame.questions[activeGame.activeQuestion].res3} </td>
								<td onclick="selectAnswer(4)" id="opt4"> ${activeGame.questions[activeGame.activeQuestion].res4} </td>
							</tr>
							
						</table>
						<br>
						<div id="AnswerSection" style="grid-row:4; grid-column:2;"> </div>
						<br>
						<div id="GameStatus" style="grid-column: 2; grid-row: 5; padding-top:20px; font-size:24px; width: 100%;">
							<div style="display:inline-block; text-align: left;"> Player: ${activeGame.name || 'You'} </div> 
							<div style="display:inline-block; text-align: right;" id="Score"> Score: &#36; ${activeGame.score}</div>
						</div>
					</div>`
			
			}
			
			function displayEndScreen(){
			
				document.getElementById('main').innerHTML = `<div style="padding:5%;">
				<div> Game completed </div>
				
				<table id="highscoreTable">
				
					<tr> <th> Name </th> <th> Score </th> </tr>
				
				</table>
				
				<div onclick="displayStartScreen();"> Main Menu </div>
				
				</div>`;
				
				let scoreData = [{name:null,score:0},{name:null,score:0},{name:null,score:0},{name:null,score:0},{name:null,score:0},
				{name:null,score:0},{name:null,score:0},{name:null,score:0},{name:null,score:0},{name:null,score:0}]; 
				
				if(typeof(window.localStorage) !== undefined){
					
					if(typeof(window.localStorage.getItem('scores')) != null){
						scoreData = window.localStorage.getItem('scores');
					}
				
				}	
			
				let x = 0;
				let hasPlayerBeenNotInserted = true;
				
				let playerString = `<tr> <td>  ${activeGame.name} </td> <td> ${activeGame.score} </td> </tr>`
				
				for(x = 0; x < 10; x++){
				
					if(activeGame.score >= scoreData[x].score && hasPlayerBeenNotInserted){
						document.getElementById("highscoreTable").innerHTML += playerString;
						hasPlayerBeenNotInserted = false;
					}
				
					let oldScore = `<tr> <td>  ${scoreData[x].name} </td> <td> ${scoreData[x].score} </td> </tr>`
					document.getElementById("highscoreTable").innerHTML += oldScore;
				
				}
			
				if(hasPlayerBeenNotInserted){
				
					document.getElementById("highscoreTable").innerHTML +=playerString;
				
				}
			
			
			}
			
			function displayLeaderBoard(){
			
				document.getElementById('main').innerHTML = `<div>
				
				<table id="highscoreTable">
				
					<tr> <th> Name </th> <th> Score </th> </tr>
				
					<tr> <td> </td> <td> </td> </tr>
				
				</table>
				
				<div onclick="displayStartScreen();"> Main Menu </div>
				
				</div>`;
				
			}
			
			
		
		
		</script>

	</body>
</html>
